"use strict";(self.webpackChunksd_webui_3d_editor=self.webpackChunksd_webui_3d_editor||[]).push([[301],{6301:function(t,e,n){n.r(e),n.d(e,{STLExporter:function(){return r}});var o=n(9477);class r{parse(t,e={}){const n=(e=Object.assign({binary:!1},e)).binary,r=[];let s,a=0;t.traverse((function(t){if(t.isMesh){const e=t.geometry,n=e.index,o=e.getAttribute("position");a+=null!==n?n.count/3:o.count/3,r.push({object3d:t,geometry:e})}}));let i=80;if(!0===n){const t=new ArrayBuffer(2*a+3*a*4*4+80+4);s=new DataView(t),s.setUint32(i,a,!0),i+=4}else s="",s+="solid exported\n";const l=new o.Pa4,u=new o.Pa4,f=new o.Pa4,c=new o.Pa4,p=new o.Pa4,d=new o.Pa4;for(let t=0,e=r.length;t<e;t++){const e=r[t].object3d,n=r[t].geometry,o=n.index,s=n.getAttribute("position");if(null!==o)for(let t=0;t<o.count;t+=3)y(o.getX(t+0),o.getX(t+1),o.getX(t+2),s,e);else for(let t=0;t<s.count;t+=3)y(t+0,t+1,t+2,s,e)}return!1===n&&(s+="endsolid exported\n"),s;function y(t,e,o,r,a){l.fromBufferAttribute(r,t),u.fromBufferAttribute(r,e),f.fromBufferAttribute(r,o),!0===a.isSkinnedMesh&&(a.applyBoneTransform(t,l),a.applyBoneTransform(e,u),a.applyBoneTransform(o,f)),l.applyMatrix4(a.matrixWorld),u.applyMatrix4(a.matrixWorld),f.applyMatrix4(a.matrixWorld),function(t,e,o){c.subVectors(o,e),p.subVectors(t,e),c.cross(p).normalize(),d.copy(c).normalize(),!0===n?(s.setFloat32(i,d.x,!0),i+=4,s.setFloat32(i,d.y,!0),i+=4,s.setFloat32(i,d.z,!0),i+=4):(s+="\tfacet normal "+d.x+" "+d.y+" "+d.z+"\n",s+="\t\touter loop\n")}(l,u,f),b(l),b(u),b(f),!0===n?(s.setUint16(i,0,!0),i+=2):(s+="\t\tendloop\n",s+="\tendfacet\n")}function b(t){!0===n?(s.setFloat32(i,t.x,!0),i+=4,s.setFloat32(i,t.y,!0),i+=4,s.setFloat32(i,t.z,!0),i+=4):s+="\t\t\tvertex "+t.x+" "+t.y+" "+t.z+"\n"}}}}}]);